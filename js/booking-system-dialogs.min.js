function bookacti_init_booking_system_dialogs(){$j(".bookacti-booking-system-dialog").dialog({modal:true,autoOpen:false,minHeight:300,minWidth:400,resize:"auto",show:true,hide:true,closeText:"&#10006;",close:function(){}});$j(".ui-widget-overlay").live("click",function(){$j("div:ui-dialog:visible").dialog("close")});$j("#bookacti-choose-group-of-events-dialog").dialog({title:bookacti_localized.dialog_choose_group_of_events_title});$j("#bookacti-groups-of-events-list").on("bookacti_group_of_events_preview",'input[name="group_of_events"]',function(f,d){var c=$j(this).val();var b=$j("#bookacti-groups-of-events-list").data("booking-system-id");var a=$j("#"+b);$j('.bookacti-group-of-events-option[data-group-id!="'+c+'"]').data("show-events",0).attr("data-show-events",0);$j('.bookacti-group-of-events-list[data-group-id!="'+c+'"]').hide(200);$j('.bookacti-group-of-events-option[data-group-id="'+c+'"]').data("show-events",1).attr("data-show-events",1);$j('.bookacti-group-of-events-list[data-group-id="'+c+'"]').show(200);bookacti_unpick_all_events(a);bookacti_pick_events_of_group(a,c,d)})}function bookacti_dialog_choose_group_of_events(f,b,s){var j=f.attr("id");var d=j==="bookacti-booking-system-bookings-page"?"booking_page":"frontend";$j("#bookacti-groups-of-events-list").data("booking-system-id",j);$j("#bookacti-groups-of-events-list").empty();if(bookacti.booking_system[j]["groups_single_events"]){var r="single";var u="";if(d==="booking_page"){var a=bookacti_get_bookings_number_for_a_single_grouped_event(f,s,b);var p=a>1?bookacti_localized.bookings:bookacti_localized.booking;u=a+" "+p}else{var l=bookacti_get_event_availability(f,s);var o=l>1?bookacti_localized.avails:bookacti_localized.avail;u=l+" "+o}var m=false;if(bookacti.booking_system[j]["events_data"][s.id]!=null){var i=parseInt(bookacti.booking_system[j]["events_data"][s.id]["activity_id"]);var q=bookacti.booking_system[j]["activities_data"][i]["settings"];var v=q.min_bookings_per_user!=null?q.min_bookings_per_user:0;if(v<=l){m=true}}var n=$j("<div />",{});var g=$j("<div />",{"class":"bookacti-group-of-events-option","data-group-id":r,"data-show-events":0});var k=$j("<input />",{id:"bookacti-group-of-events-"+r,type:"radio",name:"group_of_events",value:r,disabled:d!=="booking_page"&&!m,});var h=$j("<label />",{html:bookacti_localized.single_event+' <span class="bookacti-group-availability" >('+u+")</span>","for":"bookacti-group-of-events-"+r});var c=$j("<ul />",{"class":"bookacti-group-of-events-list","data-group-id":r});var t=bookacti_format_event_duration(s.start,s.end);var e=$j("<li />",{html:'<span class="bookacti-booking-event-title" >'+s.title+'</span><span class="bookacti-booking-event-title-separator" > - </span>'+t});g.append(k);g.append(h);n.append(g);c.append(e);n.append(c);$j("#bookacti-groups-of-events-list").append(n)}$j.each(b,function(E,L){L=parseInt(L);if(typeof bookacti.booking_system[j]["groups_events"][L]!=="undefined"){var C=bookacti_get_group_availability(f,bookacti.booking_system[j]["groups_events"][L]);var B=false;if(bookacti.booking_system[j]["groups_data"][L]!=null){var A=parseInt(bookacti.booking_system[j]["groups_data"][L]["category_id"]);var H=bookacti.booking_system[j]["group_categories_data"][A]["settings"];var I=H.min_bookings_per_user!=null?H.min_bookings_per_user:0;if(I<=C&&C>0){B=true}}var x=$j("<div />",{});var D=$j("<div />",{"class":"bookacti-group-of-events-option","data-group-id":L,"data-show-events":0});var z=$j("<input />",{id:"bookacti-group-of-events-"+L,type:"radio",name:"group_of_events",disabled:d!=="booking_page"&&!B,value:L});var K="";if(d==="booking_page"){var M=0;$j.each(bookacti.booking_system[j]["groups_events"][L],function(O,N){if(s.id==N.id&&s.start.format("YYYY-MM-DD HH:mm:ss")===N.start&&s.end.format("YYYY-MM-DD HH:mm:ss")===N.end){M=N.group_bookings}});var y=M>1?bookacti_localized.bookings:bookacti_localized.booking;K=M+" "+y}else{var G=C>1?bookacti_localized.avails:bookacti_localized.avail;K=C+" "+G}var F={html:bookacti.booking_system[j]["groups_data"][L]["title"]+' <span class="bookacti-group-availability" >('+K+")</span>","for":"bookacti-group-of-events-"+L};f.trigger("bookacti_choose_group_dialog_group_label",[F,L,s]);var J=$j("<label />",F);var w=$j("<ul />",{"class":"bookacti-group-of-events-list","data-group-id":L});$j.each(bookacti.booking_system[j]["groups_events"][L],function(Q,T){var O=T.start.substr(0,10)===T.end.substr(0,10);var S=moment(T.start).locale(bookacti_localized.current_lang_code);var P=moment(T.end).locale(bookacti_localized.current_lang_code);var N=S.formatPHP(bookacti_localized.date_format)+bookacti_localized.dates_separator+P.formatPHP(bookacti_localized.date_format);if(O){N=S.formatPHP(bookacti_localized.date_format)+bookacti_localized.date_time_separator+P.formatPHP(bookacti_localized.time_format)}var R=$j("<li />",{html:T.title+" - "+N});w.append(R)});D.append(z);D.append(J);x.append(D);x.append(w);$j("#bookacti-groups-of-events-list").append(x)}});$j('#bookacti-groups-of-events-list input[name="group_of_events"]').on("change",function(){$j(this).trigger("bookacti_group_of_events_preview",[s])});$j('#bookacti-groups-of-events-list input[name="group_of_events"]:not([disabled]):first').prop("checked",true).trigger("change");$j("#bookacti-choose-group-of-events-dialog").dialog("open");$j("#bookacti-choose-group-of-events-dialog").dialog({close:function(){var w=$j('#bookacti-groups-of-events-list input[type="radio"]:checked').val();if(typeof w==="undefined"){bookacti_unpick_all_events(f)}}});$j("#bookacti-choose-group-of-events-dialog").dialog("option","buttons",[{text:bookacti_localized.dialog_button_ok,click:function(){var w=$j('#bookacti-groups-of-events-list input[type="radio"]:checked').val();bookacti_unpick_all_events(f);bookacti_pick_events_of_group(f,w,s);f.trigger("bookacti_group_of_events_chosen",[w,s]);$j(this).dialog("close")}}])};