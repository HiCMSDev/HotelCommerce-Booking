$j(document).ready(function(){if(!$j("form#bookacti-form-editor-page-form").length){return}bookacti_init_form_editor_dialogs();bookacti_init_form_editor_actions()});function bookacti_init_form_editor_dialogs(){$j(".bookacti-form-dialog").dialog({modal:true,autoOpen:false,minHeight:300,minWidth:440,resize:"auto",show:true,hide:true,dialogClass:"bookacti-dialog",closeText:"&#10006;",close:function(){}});$j(".ui-widget-overlay").live("click",function(){$j("div:ui-dialog:visible").dialog("close")});$j("#bookacti-insert-form-field-dialog").dialog({title:bookacti_localized.form_field_action_insert});$j("#bookacti-remove-form-field-dialog").dialog({title:bookacti_localized.form_field_action_remove})}function bookacti_init_form_editor_actions(){$j("#bookacti-form-editor-actions").on("click",".bookacti-form-editor-action",function(a){a.stopPropagation();if($j(this).is("#bookacti-insert-form-field")){bookacti_dialog_insert_form_field()}});$j("#bookacti-form-editor").on("click",".bookacti-form-editor-field-action",function(b){b.stopPropagation();var a=$j(this).closest(".bookacti-form-editor-field").data("field-id");if($j(this).hasClass("bookacti-remove-form-field")){bookacti_dialog_remove_form_field(a)}})}function bookacti_dialog_insert_form_field(){$j("#bookacti-insert-form-field-dialog").dialog("open");$j("#bookacti-insert-form-field-dialog").dialog("option","buttons",[{text:bookacti_localized.dialog_button_cancel,click:function(){$j(this).dialog("close")}},{text:bookacti_localized.dialog_button_ok,click:function(){var a=$j("#bookacti-form-id").val();var c=$j("#bookacti-field-to-insert").val();var b=$j("#nonce_insert_form_field").val();if(!c||!a||!b){return}bookacti_form_editor_enter_loading_state();$j.ajax({url:ajaxurl,type:"POST",data:{action:"bookactiInsertFormField",form_id:a,field_name:c,nonce:b},dataType:"json",success:function(e){if(e.status==="success"){$j("#bookacti-form-editor").append(e.field_html)}else{if(e.status==="failed"){var d=bookacti_localized.error_insert_form_field;if(e.error==="not_allowed"){d+="\n"+bookacti_localized.error_not_allowed}console.log(d);console.log(e)}}},error:function(d){console.log("AJAX "+bookacti_localized.error_insert_form_field);console.log(d)},complete:function(){bookacti_form_editor_exit_loading_state()}});$j(this).dialog("close")}}])}function bookacti_dialog_remove_form_field(a){$j("#bookacti-remove-form-field-dialog").dialog("open");$j("#bookacti-remove-form-field-dialog").dialog("option","buttons",[{text:bookacti_localized.dialog_button_cancel,click:function(){$j(this).dialog("close")}},{text:bookacti_localized.dialog_button_ok,click:function(){var b=$j("#nonce_remove_form_field").val();if(!a||!b){return}bookacti_form_editor_enter_loading_state();$j.ajax({url:ajaxurl,type:"POST",data:{action:"bookactiRemoveFormField",field_id:a,nonce:b},dataType:"json",success:function(d){if(d.status==="success"){$j("#bookacti-form-editor-field-"+a).remove()}else{if(d.status==="failed"){var c=bookacti_localized.error_remove_form_field;if(d.error==="not_allowed"){c+="\n"+bookacti_localized.error_not_allowed}console.log(c);console.log(d)}}},error:function(c){console.log("AJAX "+bookacti_localized.error_remove_form_field);console.log(c)},complete:function(){bookacti_form_editor_exit_loading_state()}});$j(this).dialog("close")}}])};