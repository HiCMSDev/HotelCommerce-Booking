$j(document).ready(function(){bookacti_init_form_dialogs();$j("body").on("click",".bookacti-forgotten-password-link",function(b){b.preventDefault();var a=$j(this).data("field-id");bookacti_dialog_forgotten_password(a)})});function bookacti_init_form_dialogs(){$j(".bookacti-form-dialog").dialog({modal:true,autoOpen:false,minHeight:300,minWidth:440,resize:"auto",show:true,hide:true,dialogClass:"bookacti-dialog",closeText:"&#10006;",beforeClose:function(){var b=".bookacti-form-dialog";var a=$j(this).attr("id");if(a){b="#"+a}bookacti_empty_all_dialog_forms(b)}});$j(".ui-widget-overlay").live("click",function(){$j("div:ui-dialog:visible").dialog("close")});$j(".bookacti-form-dialog").on("keydown",function(a){if(!$j("textarea").is(":focus")&&a.keyCode==$j.ui.keyCode.ENTER){$j(this).parent().find(".ui-dialog-buttonpane button:first").focus();return false}})}function bookacti_dialog_forgotten_password(b){var c=$j('.bookacti-forgotten-password-link[data-field-id="'+b+'"]');var a=$j('.bookacti-forgotten-password-dialog[data-field-id="'+b+'"]');if(!a.length){a=$j(".bookacti-forgotten-password-dialog:first")}a.dialog("open");a.dialog("option","buttons",[{text:bookacti_localized.dialog_button_ok,click:function(){a.find(".bookacti-loading-alt, .bookacti-notices").remove();var d=a.find(".bookacti-forgotten-password-email").val();var e=a.find(".bookacti-nonce-forgotten-password").val();if(!d||!e){return}var f='<div class="bookacti-loading-alt"><img class="bookacti-loader" src="'+bookacti_localized.plugin_path+'/img/ajax-loader.gif" title="'+bookacti_localized.loading+'" /><span class="bookacti-loading-alt-text" >'+bookacti_localized.loading+"</span></div>";a.append(f);$j.ajax({url:ajaxurl,type:"POST",data:{action:"bookactiForgottenPassword",email:d,nonce:e},dataType:"json",success:function(h){if(h.status==="success"){if(typeof h.message!=="undefined"){a.append('<div class="bookacti-notices"><ul class="bookacti-success-list"><li>'+h.message+"</li></ul></div>")}$j("body").trigger("bookacti_forgotten_password_email_sent",[d,h])}else{if(h.status==="failed"){var g=bookacti_localized.error_send_email;if(h.error==="not_allowed"){g+="<br/>"+bookacti_localized.error_not_allowed}if(typeof h.message!=="undefined"){g=h.message}a.append('<div class="bookacti-notices"><ul class="bookacti-error-list"><li>'+g+"</li></ul></div>");console.log(h)}}},error:function(g){a.append('<div class="bookacti-notices"><ul class="bookacti-error-list"><li>AJAX '+bookacti_localized.error_send_email+"</li></ul></div>");console.log(g)},complete:function(){a.find(".bookacti-notices").show();a.find(".bookacti-loading-alt").remove()}})}}])};