$j(document).ready(function(){$j(".bookacti-booking-form").on("submit",function(f){f.preventDefault();var b=$j(this);var a=b.find(".bookacti-booking-system");b.find('.bookacti-form-field-name-submit input[type="submit"]').prop("disabled",true);if(typeof bookacti_localized.current_user_id==="undefined"||bookacti_localized.current_user_id==null||bookacti_localized.current_user_id==0){a.siblings(".bookacti-notices").empty().append("<ul class='bookacti-error-list'><li>"+bookacti_localized.error_user_not_logged_in+"</li></ul>").show();b.find('.bookacti-form-field-name-submit input[type="submit"]').prop("disabled",false);return false}var d=bookacti_validate_picked_events(a,b.find(".bookacti-quantity").val());if(!d){b.find('.bookacti-form-field-name-submit input[type="submit"]').prop("disabled",false);return false}else{b.find(".bookacti-booking-system-container").trigger("bookacti_submit_booking_form");var c=b.serialize();bookacti_start_loading_booking_system(a);$j.ajax({url:bookacti_localized.ajaxurl,type:"POST",data:c,dataType:"json",success:function(e){b.find(".bookacti-booking-system-container").trigger("bookacti_booking_form_submitted",[e]);var g="";if(e.status==="success"){b.find('.bookacti-form-field-container:not(.bookacti-form-field-name-submit):not(.bookacti-form-field-name-calendar), .bookacti-form-field-name-submit input[type="submit"]').hide();b.find(".bookacti-form-field-name-submit").append('<input type="button" class="bookacti-new-booking-button" value="'+bookacti_localized.booking_form_new_booking_button+'" />');g="<ul class='bookacti-success-list bookacti-persistent-notice'><li>"+e.message+"</li></ul>";if(b.attr("action")!==""){window.location.replace(b.attr("action"))}else{bookacti_refresh_booking_numbers(a)}}else{g="<ul class='bookacti-error-list'><li>"+e.message+"</li></ul>"}a.siblings(".bookacti-notices").empty().append(g).show()},error:function(h){var g="<ul class='bookacti-error-list'><li>AJAX "+bookacti_localized.error_book+"</li></ul>";a.siblings(".bookacti-notices").empty().append(g).show();console.log("AJAX "+bookacti_localized.error_book);console.log(h)},complete:function(){bookacti_stop_loading_booking_system(a);b.find('.bookacti-form-field-name-submit input[type="submit"]').prop("disabled",false)}})}});$j(".bookacti-booking-form").on("click",".bookacti-new-booking-button",function(){var b=$j(this).parents("form");var a=b.find(".bookacti-booking-system");bookacti_clear_booking_system_displayed_info(a);b.find('.bookacti-form-field-container:not(.bookacti-form-field-name-submit), .bookacti-form-field-name-submit input[type="submit"]').show();$j(this).remove()});$j(".bookacti-booking-form").on("keyup mouseup","input.bookacti-quantity",function(){var a=$j(this).parents("form").find(".bookacti-booking-system");if(a.length){bookacti_fill_picked_events_list(a)}});$j(".bookacti-booking-form").on("bookacti_picked_events_list_data",".bookacti-booking-system",function(f,b,d){var a=$j(this);var c=a.parents("form").find("input.bookacti-quantity");if(c.length){bookacti_set_min_and_max_quantity(a,c,b)}});$j("form.bookacti-booking-form .bookacti-booking-system").on("bookacti_view_refreshed bookacti_displayed_info_cleared",function(b){var a=$j(this).parents("form");a.find('input[name="quantity"]').attr("disabled",false);a.find('button[type="submit"]').attr("disabled",false)});$j("form.bookacti-booking-form .bookacti-booking-system").on("bookacti_error_displayed",function(b){var a=$j(this).parents("form");a.find('input[name="quantity"]').attr("disabled",true);a.find('button[type="submit"]').attr("disabled",true)})});