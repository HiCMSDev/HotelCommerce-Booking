$j(document).ready(function(){bookacti_show_hide_activity_tab();$j(".type_box select, .type_box input").on("change",function(){bookacti_show_hide_activity_tab()});if($j("#_bookacti_template").length){bookacti_show_hide_template_related_options("#_bookacti_template")}$j("#_bookacti_template, bookacti_variable_template").on("change",function(){bookacti_show_hide_template_related_options(this)});$j("#woocommerce-product-data").on("change",".bookacti-multiple-select",function(){bookacti_switch_select_to_multiple(this)});$j("#woocommerce-product-data").on("woocommerce_variations_loaded",function(){bookacti_show_hide_activity_variation_fields();$j("#woocommerce-product-data .bookacti_variable_template").each(function(){bookacti_show_hide_template_related_options(this,true)})});$j("#woocommerce-product-data").on("change",".bookacti_variable_is_activity",function(){bookacti_show_hide_activity_variation_fields(this)});$j("#woocommerce-product-data").on("change",".bookacti_variable_template",function(){bookacti_show_hide_template_related_options(this,true)});$j("#woocommerce-product-data").on("change",".variable_is_virtual",function(){if($j(this).parents(".options").find(".bookacti_variable_is_activity").is(":checked")){if(!$j(this).is(":checked")){$j(this).prop("checked",true).trigger("change")}}});$j(".bookacti-guest-checkout-notice .notice-dismiss").on("click",function(){bookacti_dismiss_guest_checkout_notice()})});function bookacti_show_hide_activity_tab(){$j(".bookacti_show_if_activity").hide();if($j("#_bookacti_is_activity").is(":checked")){if(($j("#product-type").val()==="simple"||$j("#product-type").val()==="variable")){$j(".bookacti_show_if_activity").show();if(!$j("#_virtual").is(":checked")){$j("#_virtual").prop("checked",true).trigger("change")}}$j(".bookacti_hide_if_activity").hide()}else{$j(".bookacti_hide_if_activity").show();if($j("#_virtual").is(":checked")){$j(".bookacti_hide_if_activity.hide_if_virtual").hide()}}}function bookacti_switch_select_to_multiple(c){var d=$j(c).data("select-id");var b=$j("select#"+d).attr("name");var a=$j(c).is(":checked");$j("select#"+d).prop("multiple",a);$j("select#"+d+' option[value="none"]').prop("disabled",a);$j("select#"+d+' option[value="parent"]').prop("disabled",a);$j("select#"+d+' option[value="site"]').prop("disabled",a);$j("select#"+d+" option:disabled:selected").prop("selected",false);$j("select#"+d+" option:not(:visible):selected").prop("selected",false);if(a&&b.indexOf("[]")<0){$j("select#"+d).attr("name",b+"[]")}else{$j("select#"+d).attr("name",b.replace("[]",""))}}function bookacti_show_hide_template_related_options(b,d){d=d?1:0;var c=$j(b).val();var a=$j("[data-bookacti-show-if-templates]");var e=[];if(d){if(c==="parent"){c=$j("#_bookacti_template").val()||$j(b).data("parent")}a=$j('[name$="['+$j(b).data("loop")+']"] [data-bookacti-show-if-templates], [name$="['+$j(b).data("loop")+'][]"] [data-bookacti-show-if-templates]')}if($j.isNumeric(c)){c=[c]}a.removeClass("bookacti-hide-fields");a.each(function(){var h=$j(this);var g=h.data("bookacti-show-if-templates").toString();if(g.indexOf(",")>=0){g=g.split(",")}else{g=[g]}var f=true;$j.each(c,function(k,j){if($j.inArray(j.toString(),g)>=0){f=false}});if(f){if(h.is(":selected")){e.push(h)}h.addClass("bookacti-hide-fields")}});$j.each(e,function(f,g){g.removeAttr("selected");g.siblings("option:not(.bookacti-hide-fields):not(:disabled):first").attr("selected","selected")})}function bookacti_show_hide_activity_variation_fields(a){a=a||undefined;if(a===undefined){$j(".show_if_variation_activity").hide();$j(".bookacti_variable_is_activity").each(function(){if($j(this).is(":checked")){$j(this).parents(".woocommerce_variation").find(".show_if_variation_activity").show()}})}else{if($j(a).is(":checked")){$j(a).parents(".woocommerce_variation").find(".show_if_variation_activity").show();if(!$j(a).parents(".options").find(".variable_is_virtual").is("checked")){$j(a).parents(".options").find(".variable_is_virtual").prop("checked",true).trigger("change")}}else{$j(a).parents(".woocommerce_variation").find(".show_if_variation_activity").hide()}}}function bookacti_dismiss_guest_checkout_notice(){$j(".bookacti-guest-checkout-notice").remove();$j.ajax({url:ajaxurl,type:"POST",data:{action:"bookactiDismissGuestCheckoutNotice",nonce:bookacti_localized.nonce_dismiss_guest_checkout_notice},dataType:"json",success:function(b){if(b.status==="failed"){var a=bookacti_localized.error_update_settings;if(b.error==="not_allowed"){a+="\n"+bookacti_localized.error_not_allowed}console.log(a);console.log(b)}},error:function(a){console.log(a)},complete:function(){}})};