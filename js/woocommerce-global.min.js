$j(document).ready(function(){$j("body").on("bookacti_booking_refunded",function(i,m,d,j,k,f,g){if(j==="auto"){f.message+=bookacti_localized.advice_booking_refunded}else{if(j==="coupon"){f.message+=bookacti_localized.advice_booking_refunded;f.message+="<br/>"+bookacti_localized.advice_coupon_created.replace("%1$s","<strong>"+g.coupon_amount+"</strong>");f.message+="<br/>"+bookacti_localized.advice_coupon_code.replace("%1$s","<strong>"+g.coupon_code+"</strong>");if(!bookacti_localized.is_admin){if(d==="single"){var l=$j('.bookacti-booking-actions[data-booking-id="'+m+'"]').parents("tr")}else{var l=$j('.bookacti-booking-group-actions[data-booking-group-id="'+m+'"]').parents("tr")}if(l.length&&g.coupon_code){var a=l.find("ul.wc-item-meta");if(a.length){if(a.find(".wc-item-meta-value.wc-item-meta-bookacti_refund_coupon").length){a.find(".wc-item-meta-value.wc-item-meta-bookacti_refund_coupon").html(g.coupon_code)}else{var h='<li><strong class="wc-item-meta-label wc-item-meta-bookacti_refund_coupon">'+bookacti_localized.coupon_code+':</strong><span class="wc-item-meta-value wc-item-meta-bookacti_refund_coupon" >'+g.coupon_code+"</span></li>";a.append(h)}}if(l.find(".variation").length){if($j("dd.variation-bookacti_refund_coupon").length){$j("dd.variation-bookacti_refund_coupon p").html(g.coupon_code)}else{var b=$j("<dt />",{"class":"variation-bookacti_refund_coupon",text:bookacti_localized.coupon_code+":"});var c=$j("<dd />",{"class":"variation-bookacti_refund_coupon"}).append($j("<p />",{text:g.coupon_code}));l.find(".variation").append(b);l.find(".variation").append(c)}}}}}}});$j("body").on("bookacti_events_picked_after",".bookacti-booking-system",function(i,h,g){var b=$j(this);var a=b.attr("id");var c=bookacti.booking_system[a];if(h==="single"&&c.when_perform_form_action==="on_event_click"){var d=bookacti_get_event_group_ids(b,g);var f=false;if($j.isArray(d)&&((d.length>1)||(d.length===1&&c.groups_single_events))){f=true}if(!f){if(c.form_action==="redirect_to_product_page"){bookacti_redirect_to_activity_product_page(b,g)}else{if(c.form_action==="add_product_to_cart"){bookacti_add_activity_product_to_cart(b,g)}}}}b.trigger("bookacti_events_picked_after_wc",[h,g])});$j("body").on("bookacti_group_of_events_chosen_after",".bookacti-booking-system",function(g,f,d){var b=$j(this);var a=b.attr("id");var c=bookacti.booking_system[a];if(c.when_perform_form_action==="on_event_click"){if(c.form_action==="redirect_to_product_page"){if(f==="single"){bookacti_redirect_to_activity_product_page(b,d)}else{if($j.isNumeric(f)){bookacti_redirect_to_group_category_product_page(b,f)}}}else{if(c.form_action==="add_product_to_cart"){if(f==="single"){bookacti_add_activity_product_to_cart(b,d)}else{if($j.isNumeric(f)){bookacti_add_group_category_product_to_cart(b,f)}}}}}b.trigger("bookacti_group_of_events_chosen_after_wc",[f,d])})});function bookacti_redirect_to_activity_product_page(c,g){var b=c.attr("id");var d=bookacti.booking_system[b];if(typeof d.events_data[g.id]==="undefined"){return}var f=d.events_data[g.id]["activity_id"];if(typeof d.product_by_activity==="undefined"){return}if(typeof d.product_by_activity[f]==="undefined"){return}var e=d.product_by_activity[f];if(typeof d.products_page_url==="undefined"){return}if(typeof d.products_page_url[e]==="undefined"){return}var a=d.products_page_url[e];bookacti_redirect_booking_system_to_url(c,a)}function bookacti_redirect_to_group_category_product_page(c,g){var b=c.attr("id");var d=bookacti.booking_system[b];if(typeof d.groups_data[g]==="undefined"){return}var f=d.groups_data[g]["category_id"];if(typeof d.product_by_group_category==="undefined"){return}if(typeof d.product_by_group_category[f]==="undefined"){return}var e=d.product_by_group_category[f];if(typeof d.products_page_url==="undefined"){return}if(typeof d.products_page_url[e]==="undefined"){return}var a=d.products_page_url[e];bookacti_redirect_booking_system_to_url(c,a)}function bookacti_add_activity_product_to_cart(b,f){var a=b.attr("id");var c=bookacti.booking_system[a];if(typeof c.events_data[f.id]==="undefined"){return}var e=c.events_data[f.id]["activity_id"];if(typeof c.product_by_activity==="undefined"){return}if(typeof c.product_by_activity[e]==="undefined"){return}var d=c.product_by_activity[e];bookacti_add_product_to_cart_via_booking_system(b,d)}function bookacti_add_group_category_product_to_cart(b,f){var a=b.attr("id");var c=bookacti.booking_system[a];if(typeof c.groups_data[f]==="undefined"){return}var e=c.groups_data[f]["category_id"];if(typeof c.product_by_group_category==="undefined"){return}if(typeof c.product_by_group_category[e]==="undefined"){return}var d=c.product_by_group_category[e];bookacti_add_product_to_cart_via_booking_system(b,d)}function bookacti_add_product_to_cart_via_booking_system(b,c){var d=b.siblings(".bookacti-notices");if(b.closest("form").length){if(b.closest("form").find("> .bookacti-notices").length){d=b.closest("form").find("> .bookacti-notices")}}d.empty();var e=[];if(!b.closest("form").length){b.closest(".bookacti-booking-system-container").wrap('<form id="bookacti-temporary-form"></form>');e=new FormData(b.closest("form").get(0));b.closest(".bookacti-booking-system-container").unwrap("form#bookacti-temporary-form")}else{var a=b.closest("form").find('input[name="action"]').val();b.closest("form").find('input[name="action"]').val("bookactiAddBoundProductToCart");e=new FormData(b.closest("form").get(0));b.closest("form").find('input[name="action"]').val(a)}bookacti_start_loading_booking_system(b);$j.ajax({url:bookacti_localized.ajaxurl,type:"POST",data:e,dataType:"json",cache:false,contentType:false,processData:false,success:function(f){if(f.status==="success"){if(!f.redirect_url){bookacti_refresh_booking_numbers(b)}else{window.location.replace(f.redirect_url)}}else{console.log(f)}if(f.messages){var h=f.status==="success"?"bookacti-success-list woocommerce":"bookacti-error-list";var g='<ul class="'+h+'"><li>'+f.messages+"</li></ul>";d.empty().append(g).show();if(f.status!=="success"||!f.redirect_url){bookacti_scroll_to(d,500,"middle")}}},error:function(g){var f='<ul class="bookacti-error-list"><li>AJAX error occured while trying to add the product to cart</li></ul>';d.empty().append(f).show();bookacti_scroll_to(d,500,"middle");console.log("AJAX error occured while trying to add the product to cart");console.log(g)},complete:function(){bookacti_stop_loading_booking_system(b)}})};